******************************8  14.3 Кража учетных данных, токенов и сессий привилегированных УЗ ***************

Кража учетных данных, токенов и сессий привилегированных УЗ

Данный подход — один из наиболее распространенных в сетях, незрелых с точки зрения ИБ заказчиков. Он подразумевает отсутствие серьезных препятствий на пути пентестера в виде разграничения доступа в сети, Tier-модели Майкрософт, механизмов Credentials Guard и пр.
14_3_1.png
 

    Пример

    Вы компрометируете машину в домене при помощи эксплойта и получаете доступ уровня NT Authority/System:

        Вы извлекаете учетные данные, ключи и токены доступа из скомпрометированной машины
        Вы пытаетесь переиспользовать полученные доступы в рамках доступной вам сети, подключаясь с полученными данными к сервисам SMB, HTTP, MSSQL, RPC, WMI и пр. 
        Вы обнаруживаете прочие машины, на которые у вас есть доступ уровня локального администратора
        На скомпрометированных машинах вы вновь извлекаете учетные записи, секреты и токены доступа, уже новых для вас учетных записей
        Так вы повторяете шаги, пока не получите учетные данные кого-либо из групп: Administrators, Domain Admins, Enterprise Admins
        Как только вы получаете эти учетные записи, вы сможете получить доступ к контроллеру домена по WMI или SMB, или выполнить атаку DCSync


Привилегированные группы

Помимо групп, которые имеют прямой доступ к управлению AD, есть группы, чьи привилегии позволяют нам получить доступ к группам первой тройки.

    Group Policy Creators Owners
    Account Operators
    Schema Admins
    Event Log Readers
    Backup Operators
    Remote Management Users
    Server Operators
    DnsAdmins

    Рассмотреть, как можно повысить доступ к каждой из описанных выше групп, можно тут.

