*****************************  15.3 Использование шифрованных каналов связи  *************************

Использование шифрованных каналов связи

Для того, чтобы активные средства защиты не могли обнаружить атакующий трафик и определить опасные конструкции в нем по сигнатурам, необходимо постоянно заботиться о том, чтобы наш трафик эксплойтов или команд невозможно было расшифровать.

Если наша задача — применить эксплойт, то желательно работать только с применением шифрования трафика прикладных протоколов (например, используя SSL/TLS).

Это могут быть такие протоколы, как:

    HTTPS
    SMB (только версии 3.1.1 и выше)
    SMTP (только на порте 465 с использованием команды STARTTLS)
    SSH

Также критически важно использовать шифрованные каналы связи с взаимодействием с нагрузкой для контроля и выполнения команд. Для этого в фреймворка C&C необходимо использовать нагрузки с связью по каналам, использующим TLS. Например, в metasploit:

    windows/meterpreter/reverse_https (В LHOST необходимо будет указывать доменное имя)
    windows/meterpreter/reverse_winhttps
    windows/meterpreter_reverse_https (нагрузка без стейджера)

